
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Luke Gorrie's blog</title>
  <meta name="author" content="Luke Gorrie">

  
  <meta name="description" content="Just for fun, here is some simple Snabb Switch example code to retransmit
every packet that is received on a set of Ethernet ports. It&#8217;s part &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.lukego.com//">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Luke Gorrie's blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-33510863-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Luke Gorrie's blog</a></h1>
  
    <h2>21st Century Network Hacking</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.lukego.com/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/06/23/echoing-packets-with-snabb-switch/">Echoing Packets With Snabb Switch</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-06-23T14:10:00+02:00" pubdate data-updated="true">Jun 23<span>rd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Just for fun, here is some simple Snabb Switch example code to retransmit
every packet that is received on a set of Ethernet ports. It&#8217;s part of
the basic selftest code in
<a href="https://github.com/SnabbCo/snabbswitch/blob/master/src/port.lua"><code>port.lua</code></a>.
The coding style is starting to settle down lately and so it&#8217;s more
tempting for me to share little snippets of code.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='lua'><span class='line'><span class="k">function</span> <span class="nf">Port</span><span class="p">:</span><span class="n">echo</span> <span class="p">()</span>
</span><span class='line'>   <span class="kd">local</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">outputs</span>
</span><span class='line'>   <span class="k">repeat</span>
</span><span class='line'>      <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="o">#</span><span class="n">inputs</span> <span class="k">do</span>
</span><span class='line'>         <span class="kd">local</span> <span class="n">input</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span class='line'>         <span class="n">input</span><span class="p">:</span><span class="n">sync_receive</span><span class="p">()</span>
</span><span class='line'>         <span class="k">while</span> <span class="n">input</span><span class="p">:</span><span class="n">can_receive</span><span class="p">()</span> <span class="ow">and</span> <span class="n">output</span><span class="p">:</span><span class="n">can_transmit</span><span class="p">()</span> <span class="k">do</span>
</span><span class='line'>            <span class="kd">local</span> <span class="n">buf</span> <span class="o">=</span> <span class="n">input</span><span class="p">:</span><span class="n">receive</span><span class="p">()</span>
</span><span class='line'>            <span class="n">output</span><span class="p">:</span><span class="n">transmit</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
</span><span class='line'>            <span class="n">buffer</span><span class="p">.</span><span class="n">deref</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
</span><span class='line'>         <span class="k">end</span>
</span><span class='line'>         <span class="k">while</span> <span class="n">input</span><span class="p">:</span><span class="n">can_add_receive_buffer</span><span class="p">()</span> <span class="k">do</span>
</span><span class='line'>            <span class="n">input</span><span class="p">:</span><span class="n">add_receive_buffer</span><span class="p">(</span><span class="n">buffer</span><span class="p">.</span><span class="n">allocate</span><span class="p">())</span>
</span><span class='line'>         <span class="k">end</span>
</span><span class='line'>         <span class="n">output</span><span class="p">:</span><span class="n">sync_transmit</span><span class="p">()</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="n">C</span><span class="p">.</span><span class="n">usleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>   <span class="k">until</span> <span class="nb">coroutine.yield</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">echo&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">nil</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Reasonably easy to understand, I hope?</p>

<p>The features of this program that I would like to draw attention to are:</p>

<ol>
<li>It is written in a high-level language, <a href="http://luajit.org/">LuaJIT</a>.</li>
<li>On one Xeon core it handles 12 million packets per second spread across <a href="https://github.com/SnabbCo/snabbswitch/wiki/Snabb-Lab">20 x 10GbE network ports</a>. This loop runs in about 85 nanoseconds per packet. And there is heaps of room for optimization left, both in the single-core and multi-core contexts.</li>
<li>It uses device drivers directly. The <code>input</code> and <code>output</code> objects are each one of our drivers for Intel 1G, <a href="https://github.com/SnabbCo/snabbswitch/blob/master/src/intel10g.lua">Intel 10G</a>, or <a href="https://github.com/SnabbCo/snabbswitch/blob/master/src/virtio.lua">Virtio</a> ethernet devices. The &#8220;buffers&#8221; are blocks of physical memory that are directly used for hardware DMA.</li>
<li>It&#8217;s written in a pretty natural style and yet doesn&#8217;t need to garbage collect. The only objects being frequently allocated and freed are the packet buffers, and those are straightforwardly reference counted with <code>buffer.ref()</code> and <code>buffer.deref()</code>.</li>
<li>There are no confusing concepts like abrupt processor interrupts, threads, locks, or special memory allocation flags. It&#8217;s plain and simple high-level user space code just like, say, the Javascript on a web page.</li>
</ol>


<p>This my friends is a taste of how I suggest we write high-speed packet networking code over the next decade or two. I hope to win you over to this way of thinking :-)</p>

<p>If you want to know more then check out the <a href="http://snabb.co/snabbswitch/">project homepage</a>, browse the <a href="https://github.com/SnabbCo/snabbswitch/blob/master/src/">code on github</a>, or browse an <a href="http://snabb.co/misc/snabbswitch-31may2013.pdf">early draft of the book</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/19/recent-talks/">Recent Talks</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-19T09:42:00+02:00" pubdate data-updated="true">Apr 19<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have given a few talks recently:</p>

<p><a href="http://www.youtube.com/watch?v=eZDWJfB9XY4&amp;list=PL4th0AZixyRE9bb8OevAb7I8RuaWJQWnO">SLIME at the Emacs Conference</a> (16 min). History of the <a href="http://en.wikipedia.org/wiki/SLIME">SLIME</a> project and tips for people writing new Emacs-based IDEs.</p>

<p><a href="http://cast.switch.ch/vod/clips/relq1zlrq/">Snabb Switch at the Swiss OpenStack User Group</a> (8 min). Introducing the <a href="http://snabb.co/snabbswitch/">Snabb Switch</a> project to people in the local OpenStack cloud computing community.</p>

<p><a href="http://cast.switch.ch/vod/clips/26uo9i576i/">Snabb Switch at the EduPERT workshop</a> (27 min). What networking problems can you address with x86 servers? and more on Snabb Switch.</p>

<p><a href="http://blip.tv/eclm/eclm2011-luke-gorrie-6263137">Teclo Networks at ECLM 2011</a> (40 min). The early days of <a href="http://www.teclo.net/">teclo.net</a> the telecom startup company founded by Common Lisp hackers.</p>

<p>This has been really fun!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/13/routing-traffic-between-local-applications-on-linux/">Routing Traffic Between Local Applications on Linux</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-13T19:48:00+02:00" pubdate data-updated="true">Apr 13<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Want to create a really interesting virtual network on your own host and test it with ordinary applications? Great! Here is how.</p>

<p>We will make the address <code>192.168.100.1</code> act like <code>127.0.0.1</code> but route packets through a custom network topology before processing them.</p>

<p>First start with any custom topology. In this example: <code>west</code> and <code>east</code> are endpoints with an Open vSwitch bridge <code>ovs</code> in between. (This would be great for applying OpenFlow rules to packets sent between local applications.)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ip link add west type veth peer name west_to_ovs
</span><span class='line'>ip link add east type veth peer name east_to_ovs
</span><span class='line'>
</span><span class='line'>ovs-vsctl add-br ovs
</span><span class='line'>ovs-vsctl add-port ovs west_to_ovs
</span><span class='line'>ovs-vsctl add-port ovs east_to_ovs
</span><span class='line'>
</span><span class='line'>for i in west west_to_ovs east east_to_ovs ovs; do
</span><span class='line'>  ip link set $i up
</span><span class='line'>done</span></code></pre></td></tr></table></div></figure>


<p>Now assign addresses and routes for these interfaces. Packets sent to <code>192.168.100.1</code> should first be routed into interface <code>west</code> then switched via <code>ovs</code> and finally delivered to <code>east</code> for processing.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ip addr add 192.168.100.2 dev west
</span><span class='line'>ip addr add 192.168.100.1 dev east
</span><span class='line'>
</span><span class='line'>ip route add 192.168.100.1 dev west
</span><span class='line'>ip route add 192.168.100.2 dev east</span></code></pre></td></tr></table></div></figure>


<p>The ingredients are in place but they don&#8217;t <em>work</em> yet. If you ping <code>192.168.100.1</code> then the packets are sent to <code>lo</code> instead of being routed through the bridge.</p>

<p>And that brings us to the trick: <a href="http://lartc.org/howto/lartc.rpdb.html">Policy Routing</a>.</p>

<p>First make Linux globally &#8220;forget&#8221; that these addresses are local.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ip route del 192.168.100.2 table local
</span><span class='line'>ip route del 192.168.100.1 table local</span></code></pre></td></tr></table></div></figure>


<p>Now packets sent to <code>192.168.100.1</code> do get routed down the right path. They are not processed at the other end though, because Linux does not remember they are local. We are half way there.</p>

<p>Next create separate routing tables strictly for when packets are received after they have traversed the switch. These tables remember that the addresses are local.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ip rule add iif west lookup 100
</span><span class='line'>ip route add local 192.168.100.2 dev west table 100
</span><span class='line'>echo 1 &gt; /proc/sys/net/ipv4/conf/west/accept_local
</span><span class='line'>
</span><span class='line'>ip rule add iif east lookup 101
</span><span class='line'>ip route add local 192.168.100.1 dev east table 101
</span><span class='line'>echo 1 &gt; /proc/sys/net/ipv4/conf/east/accept_local</span></code></pre></td></tr></table></div></figure>


<p>Now we are done!</p>

<p>If you connect to <code>192.168.100.1</code> then your packets will first traverse the bridge and then be processed locally. The setup is symmetric so that return traffic will be routed back through the bridge too. This will work with all your favourite programs like <code>ping</code>, <code>curl</code>, <code>apache</code>, etc. Check it out by running <code>tcpdump</code> on <code>west</code> or <code>east</code>.</p>

<p>Go ahead and create interesting virtual networks on your own machine.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/03/snabb-my-lab/">Snabb - My Lab</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-03T14:42:00+02:00" pubdate data-updated="true">Apr 3<span>rd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I love my little company, <a href="http://snabb.co/">Snabb</a>. It is <a href="http://sivers.org/laboratory">my laboratory</a>.</p>

<p>My lab makes me productive in society. I write really cool open source code for anybody to use, and I earn money by traveling around <strong>meeting interesting people</strong> and helping them to solve important problems. I have &#8220;hard fun&#8221; looking for ways to do these things in harmony.</p>

<p>My lab is where I can <strong>be creative</strong>. I can ask myself, after 25 years of thoughtful programming, <em>what&#8217;s the right way to do fast ethernet I/O?</em> and then develop my answer: a small <a href="https://github.com/SnabbCo/snabbswitch/blob/master/src/intel10g.lua">10G Ethernet device driver</a> written in LuaJIT and embedded in the application. Fun!</p>

<p>My lab lets me <strong>work with friendly people</strong> in the open source world. I get to take part in the conversation on how to write networking software, and I can collaborate on equal footing with other clever hackers who have their own interests and labs, big and small.</p>

<p>My lab lets me <strong>buy fun toys</strong> (without asking permission :-)). Any day now I will receive a <a href="https://groups.google.com/forum/?fromgroups=#!topic/snabb-devel/vUd2DZZ-ctw">server with twenty 10G ethernet ports</a> to share with everybody hacking on the <a href="http://snabb.co/snabbswitch/">Snabb Switch</a> project. We get to break new ground together in the spirit of creative fun.</p>

<p>My lab lets me create software of <strong>enduring value</strong>. I do not have to constrain my code with secrecy and license restrictions, which means that it can take on a life of its own. The software can follow its own strong tendency to spread and thrive. I have just given a talk about SLIME at the first Emacs conference &#8211; 10-year-old work on a 37-year-old editor and still in widespread use!</p>

<p>My lab lets me <strong>choose</strong> to do all of these things, all by myself, and it would let me choose to do something completely different if that was what I wanted. It lets me decide when to work from my house in the Swiss Alps, a beach in Thailand, my family&#8217;s home in Australia, a cosy cafe in a big city, or a friendly office. It makes me abundantly wealthy in freedom and independence.</p>

<p>In summary I feel that I am close to a local maximum for <strong>creativity and freedom</strong>.</p>

<p>The problem has never been to &#8220;make&#8221; the company a success, but rather to <strong>preserve</strong> the great situation that I already had from the first day. On the one hand I need to avoid things like running out of money, selling shares, and signing employment contracts, and on the other hand I need to keep writing cool open source software and finding people with important problems I can help with. This way I can keep on being <a href="http://us1.campaign-archive2.com/?u=ebf088d153799238adff7f681&amp;id=5e842b4e52">proud</a> of my company.</p>

<blockquote>
A man is a success if he wakes up in the morning and goes to bed at night and in between does what he wants to do.- Bob Dylan
</blockquote>


<p>Know what I mean? I would be happy to <strong>hear from you</strong> on luke@snabb.co.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/04/cute-code/">Cute Code</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-04T15:46:00+01:00" pubdate data-updated="true">Feb 4<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today was one of those pleasant days when I know it&#8217;s not the time for serious programming.</p>

<p>I had a lovely twitter conversation with <a href="http://twitter.com/tapoueh">Dimitri Fontaine</a>, <a href="http://twitter.com/fanf">Tony Finch</a>, and <a href="http://twitter.com/janl">Jan Lehnardt</a>. I started out wanting to recommend a data structure to <a href="https://github.com/rahul-mr">@rahul-mr</a> for easily garbage collecting <a href="http://snabb.co/snabbswitch/">Snabb Switch</a>&#8217;s ethernet forwarding table. Trouble is, I don&#8217;t know the name of the data structure, so I posted this implementation in <a href="https://gist.github.com/4706097">a gist</a> and asked if anybody knows what it&#8217;s called. Here&#8217;s the code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='lua'><span class='line'><span class="c1">-- Table structure that &quot;garbage collects&quot; not-recently-used items in O(1) time.</span>
</span><span class='line'>
</span><span class='line'><span class="c1">-- Three operations are supported:</span>
</span><span class='line'><span class="c1">--   insert(k,v): add a new value</span>
</span><span class='line'><span class="c1">--   lookup(k): lookup an existing value</span>
</span><span class='line'><span class="c1">--   age(): delete old entries (that have not been used since previous call to age())</span>
</span><span class='line'>
</span><span class='line'><span class="c1">-- Initialize &#39;old&#39; and &#39;new&#39; to empty tables</span>
</span><span class='line'><span class="kd">local</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'><span class="k">function</span> <span class="nf">insert</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span class='line'>  <span class="n">new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">function</span> <span class="nf">lookup</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span><span class='line'>  <span class="k">if</span> <span class="n">new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">then</span>
</span><span class='line'>    <span class="c1">-- Found in new table</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span class='line'>  <span class="k">elseif</span> <span class="n">old</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">then</span>
</span><span class='line'>    <span class="c1">-- Migrate from old table to new table</span>
</span><span class='line'>    <span class="n">new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">old</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">old</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="c1">-- Not found</span>
</span><span class='line'>    <span class="k">return</span> <span class="kc">nil</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">function</span> <span class="nf">age</span><span class="p">()</span>
</span><span class='line'>  <span class="c1">-- Entries in &#39;old&#39; are dropped, entries in &#39;new&#39; become old.</span>
</span><span class='line'>  <span class="n">old</span> <span class="o">=</span> <span class="n">new</span>
</span><span class='line'>  <span class="n">new</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">-- empty table</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>And the twitterverse helped me rewrite this much more concisely:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='lua'><span class='line'><span class="kd">local</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
</span><span class='line'><span class="k">function</span> <span class="nf">insert</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="n">new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span> <span class="k">return</span> <span class="n">v</span>               <span class="k">end</span>
</span><span class='line'><span class="k">function</span> <span class="nf">lookup</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>    <span class="k">return</span> <span class="n">new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">insert</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">old</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">end</span>
</span><span class='line'><span class="k">function</span> <span class="nf">age</span><span class="p">()</span>        <span class="n">old</span><span class="p">,</span> <span class="n">new</span> <span class="o">=</span> <span class="n">new</span><span class="p">,</span> <span class="p">{}</span>                 <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>which I find rather aesthetically satisfying.</p>

<p>Rewriting code more concisely is one of my favorite activities. Lisp is my usual tool of choice for this purpose, so I tried a translation just for fun:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='common-lisp'><span class='line'><span class="p">(</span><span class="nb">defvar</span> <span class="vg">*new*</span> <span class="p">(</span><span class="nb">make-hash-table</span><span class="p">))</span>
</span><span class='line'><span class="p">(</span><span class="nb">defvar</span> <span class="vg">*old*</span> <span class="p">(</span><span class="nb">make-hash-table</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">defun</span> <span class="nv">insert</span> <span class="p">(</span><span class="nv">k</span> <span class="nv">v</span><span class="p">)</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">when</span> <span class="nv">v</span> <span class="p">(</span><span class="nb">setf</span> <span class="p">(</span><span class="nb">gethash</span> <span class="vg">*new*</span> <span class="nv">k</span><span class="p">)</span> <span class="nv">v</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">defun</span> <span class="nv">lookup</span> <span class="p">(</span><span class="nv">k</span> <span class="nv">v</span><span class="p">)</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nb">gethash</span> <span class="vg">*new*</span> <span class="nv">k</span><span class="p">)</span> <span class="p">(</span><span class="nv">insert</span> <span class="nv">k</span> <span class="p">(</span><span class="nb">gethash</span> <span class="vg">*old*</span> <span class="nv">k</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">defun</span> <span class="nv">age</span> <span class="p">()</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">rotatef</span> <span class="vg">*old*</span> <span class="vg">*new*</span><span class="p">)</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">clrhash</span> <span class="vg">*new*</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>and I found it interesting that the Lua version is so much more compact than the Lisp version. Sure, I&#8217;ve compacted it with whitespace tweakery and so on, but each version is as concise as I feel comfortable making it. So I wonder if Lua is becoming my preferred vehicle for writing pseudo-pseudo-code and indulging in cutenesses?</p>

<p>Then having <em>cuteness</em> cross my mind I couldn&#8217;t help but think back to cute code I&#8217;ve worked on before. I wrote my own favorite bit of cute production code in the OLPC firmware <a href="http://tracker.coreboot.org/trac/openfirmware/browser/dev/hdaudio/core.fth">HD Audio driver</a>. You see, the firmware is allowed to hard-code knowledge of the physical design of the laptop and motherboard. This bit of firmware code tells the audio chip explicit details such as the size and color of each physical audio jack in the laptop. The chip can later provide this information to the operating system for presentation to a user, for example in an audio mixer application.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>porta  config(  1/8&quot; green left hp-out jack     )config
</span><span class='line'>porta  config(  1/8&quot; green left hp-out jack     )config
</span><span class='line'>portb  config(  1/8&quot; pink left mic-in jack      )config
</span><span class='line'>portc  config(  builtin internal top mic-in no-detect other-analog )config
</span><span class='line'>portd  config(  unused line-out no-detect       )config
</span><span class='line'>porte  config(  unused line-out no-detect       )config
</span><span class='line'>portf  config(  unused line-out no-detect       )config
</span><span class='line'>portg  config(  builtin internal front speaker no-detect other-analog )config
</span><span class='line'>porth  config(  unused line-out no-detect       )config
</span><span class='line'>porti  config(  unused line-out no-detect       )config
</span><span class='line'>portj  config(  unused line-out no-detect       )config
</span><span class='line'>portk  config(  unused line-out no-detect       )config
</span></code></pre></td></tr></table></div></figure>


<p>The code reads a bit like english - <em>1/8&#8221; pink left mic-in jack</em> - but is actually purely imperative Forth code that was inspired by the wonderful book <a href="http://thinking-forth.sourceforge.net">Thinking Forth</a>.</p>

<p>So it goes!</p>

<p>P.S. I never did work out the canonical name of the data structure. Please drop me an email on <code>luke@snabb.co</code> if you know.</p>

<p><a href="https://twitter.com/lukego" class="twitter-follow-button" data-show-count="false">Follow @lukego</a></p>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/05/kernel-bypass-networking-in-snabb-switch/">Snabb Switch&#8217;s Kernel-bypass Networking</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-05T15:16:00+01:00" pubdate data-updated="true">Jan 5<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Snabb Switch has built-in <a href="http://blog.lukego.com/blog/2013/01/04/kernel-bypass-networking/">kernel-bypass networking</a> support. The switch is <a href="http://blog.lukego.com/blog/2012/10/28/firmware-vs-software/">engineered as firmware</a> and that means regarding hardware specifications on equal footing with software APIs when designing subsystems. My personal conclusion for this project is that hardware network interfaces from Intel compare favourably with software interfaces from third-party API developers. So I have written the code to talk directly to the hardware.</p>

<p>Here are the most notable features of the design:</p>

<ul>
<li>It&#8217;s special-purpose: exactly the features that benefit the application.</li>
<li>It&#8217;s written 100% from scratch, including the base ethernet device driver.</li>
<li>It&#8217;s small: about 1 KLOC of <a href="https://github.com/SnabbCo/snabbswitch/blob/master/src/intel.lua">source code</a>; about 20KB of object code.</li>
<li>It&#8217;s <a href="http://blog.lukego.com/blog/2013/01/03/snabb-switchs-luajit-ethernet-device-driver/">fast</a>: tens of millions of packets per second.</li>
<li>It supports Intel hardware: great quality in all shapes and sizes.</li>
<li>It runs on any modern Linux kernel. No kernel module or device driver needed.</li>
<li>It&#8217;s portable to other platforms: Give it access to hardware (physical RAM, raw PCI) and it takes care of everything else.</li>
<li>It&#8217;s independent. No forks to maintain, no upstreams to feed, no license fees to pay.</li>
</ul>


<p>This design suits Snabb Switch very well. In the future I foresee support for more Intel NICs, more advanced NIC features, more operating systems, and more hardware families. This will be a fun challenge over the months and years ahead.</p>

<p>Self-reliance FTW!</p>

<p>(<a href="http://www.reddit.com/r/snabb/comments/160awa/snabb_switchs_kernelbypass_networking_luke/">Comment on Snabb Switch Reddit</a>)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/04/kernel-bypass-networking/">Kernel-bypass Networking</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-04T14:13:00+01:00" pubdate data-updated="true">Jan 4<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Kernel-bypass networking is gaining popularity. This means moving
control of Ethernet hardware directly into userspace processes to
avoid the overhead of communicating with the operating system
kernel. This gives userspace all of the raw performance traditionally
enjoyed by the kernel &#8211; and all of the responsibility too. This is important for certain specialized applications that can gain as much as <a href="http://info.iet.unipi.it/~luigi/papers/20120503-netmap-atc12.pdf">20x more performance</a>.</p>

<p>Here is a selection of the many kernel-bypass solutions that are available:</p>

<ul>
<li><a href="http://www.ntop.org/products/pf_ring/dna/">ntop.org DNA</a>.</li>
<li><a href="http://info.iet.unipi.it/~luigi/netmap/">netmap</a>.</li>
<li><a href="http://www.intel.com/p/en_US/embedded/hwsw/technology/packet-processing">Intel DPDK</a>.</li>
<li>Myricom <a href="https://www.myricom.com/software/sniffer10g.html">Sniffer10G</a> and <a href="https://www.myricom.com/software/dbl.html">DBL</a>.</li>
<li><a href="http://www.6wind.com/6windgate-software">6WINDGate</a>.</li>
<li>SolarFlare <a href="http://www.openonload.org">OpenOnload</a>.</li>
<li><a href="http://www.napatech.com/products/network_adapters.html">Napatech</a>.</li>
</ul>


<p>These products each take their own design approaches and it&#8217;s
interesting to consider choices that they make.</p>

<ul>
<li>Customized kernel device driver. netmap and DNA both fork standard
Intel drivers with extensions to map I/O memory into userspace.</li>
<li>Custom hardware. Myricom and Napatech both distribute bespoke device drivers for their own custom hardware (ASIC for Myricom and FPGA for Napatech).</li>
<li>Userspace library. These solutions each provide unique libraries to access their extensions. The scope varies tremendously: Ethernet I/O, libpcap compatibility, hardware-assisted traffic dispatching for multiprocessing, buffer memory management, all the way up to entire TCP/IP socket layers.</li>
<li>Licensing. netmap is open-source, DNA requires a modest license for its userspace library, Napatech requires an NDA and depends on very expensive hardware.</li>
</ul>


<p>If you are developing high-speed (10+ Gbps) networking applications
then you should seriously consider using one of these solutions. If
you are an expert on one of these solutions then please tell us about
it <a href="http://www.reddit.com/r/snabb/comments/15y73y/kernelbypass_networking_luke_gorries_blog/">on the Snabb Switch Reddit</a>!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/03/snabb-switchs-luajit-ethernet-device-driver/">Snabb Switch&#8217;s LuaJIT Ethernet Device Driver</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-03T09:57:00+01:00" pubdate data-updated="true">Jan 3<span>rd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I am having fun while writing the <a href="http://www.snabb.co/snabbswitch/">Snabb Switch</a> Ethernet device driver.
This is like Intel&#8217;s standard <a href="http://sourceforge.net/projects/e1000/">E1000/IGB/IGBE driver for Linux</a> except that:</p>

<ul>
<li>It is written in <a href="http://www.luajit.org/">LuaJIT</a>. (It&#8217;s my first LuaJIT program, I&#8217;m a newbie.)</li>
<li>It runs in a normal Linux userspace process but talks directly to hardware.</li>
<li>It is tailor made for one application, a simple hypervisor-friendly ethernet switch.</li>
</ul>


<p>I have been optimizing the LuaJIT selftest code to transmit ethernet
packets in a loop. I am pretty encouraged by the performance that I
see: 3.1% CPU utilization on a low-end <a href="http://www.hetzner.de/en/hosting/produkte_rootserver/ex6">Hetzner
EX6</a> machine
to saturate a 1Gbps ethernet port with tiny packets. That is 28
nanoseconds of CPU time per packet.</p>

<p>I hope the details will be interesting. It is not so often that people
write about low-level networking in high-level dynamic programming
languages, is it? So, to give a quick taste, the driver source code is
in
<a href="https://github.com/SnabbCo/snabbswitch/blob/master/src/intel.lua">intel.lua</a>
and the selftest main loop works like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='lua'><span class='line'><span class="kd">local</span> <span class="n">deadline</span> <span class="o">=</span> <span class="n">C</span><span class="p">.</span><span class="n">get_time_ns</span><span class="p">()</span> <span class="o">+</span> <span class="mi">10000000000</span><span class="n">LL</span>
</span><span class='line'><span class="k">repeat</span>
</span><span class='line'>   <span class="k">while</span> <span class="n">tx_load</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.75</span> <span class="k">do</span> <span class="n">C</span><span class="p">.</span><span class="n">usleep</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span> <span class="k">end</span>
</span><span class='line'>   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tx_available</span><span class="p">()</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">add_txbuf</span><span class="p">(</span><span class="n">dma_phys</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
</span><span class='line'>   <span class="k">end</span>
</span><span class='line'>   <span class="n">flush_tx</span><span class="p">()</span>
</span><span class='line'><span class="k">until</span> <span class="n">C</span><span class="p">.</span><span class="n">get_time_ns</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">deadline</span>
</span></code></pre></td></tr></table></div></figure>


<p>and here is what that means:</p>

<ul>
<li>Sleep while the hardware transmit queue is at least 75% full (<code>tx_load</code>).</li>
<li>Fill up the transmit queue with 60-byte packets (<code>add_txbuf</code>).</li>
<li>Tell the NIC hardware to process the transmit queue (<code>flush_tx</code>).</li>
<li>Stop after 10 seconds have elapsed (<code>get_time_ns</code>).</li>
</ul>


<p>This is all accomplished by directly controlling the NIC using
memory-mapped register I/O and DMA with shared memory. The only
operating system calls here are to sleep and check the time.</p>

<p>This is a really fun sort of programming to be doing!</p>

<p>Going forward I am really excited to see how much of a production
quality Ethernet switch can be written in a high-level dynamic
programming language, and how neatly any parts that are ultimately
written in C can be integrated into the whole. This is an open source
project and you are welcome to join in the fun too!</p>

<p>(Comments welcome <a href="http://www.reddit.com/r/snabb/comments/15vqp0/snabb_switchs_luajit_ethernet_device_driver_luke/">on the Snabb Switch Reddit</a>.)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/08/tech-mesh-2012-trip-report/">Tech Mesh 2012 Trip Report</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-08T00:15:00+01:00" pubdate data-updated="true">Dec 8<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I had a great time at the <a href="http://techmeshconf.com/techmesh-london-2012/">Tech Mesh</a> conference in London this week. Hearty thanks to everybody who made it happen. These are my impressions.</p>

<p>Stuart Bailey&#8217;s talk was heartwarming. He&#8217;s an Erlang guy who&#8217;s finally meeting other Erlang people in the flesh. &#8220;Honey, you wouldn&#8217;t believe it, I can talk about Erlang here and they don&#8217;t look at me like I&#8217;m crazy.&#8221; I think it&#8217;s a beautiful moment that many of us can relate to.</p>

<p>Amazingly, Lisp code was on screens all over the place with no fuss being made whatsoever. This was all Clojure. Rich Hickey was there. I&#8217;d heard him speak once before, five years ago at the Lisp 50th anniversary event at OOPSLA, where everybody looked to him as the great hope to give Lisp a fresh start. Looks to me like he has delivered on what he promised. Great work Rich! That is no small feat.</p>

<p>I met a lot of friendly and interesting people. Haskell hackers, Xen hackers, even another Queenslander like me. I found the boyish enthusiasm of Simon Peyton Jones and Joe Armstrong very infectious, as always. I was also really glad to meet up with a lot of my old friends from the Stockholm Erlang scene.</p>

<p>The language runtime panel reminded me of one idea that&#8217;s been rattling around in my head forever. Take it as given that (a) the Erlang VM is great for concurrency because it gives you efficient process isolation and (b) hardware advances are making the Linux kernel&#8217;s process isolation more efficient every year. So when will it be time to start using the Linux kernel as an Erlang-like language runtime environment? If you strip away all the layers of crud on top, are we already there? This seems like valid research question.</p>

<p>I like the overall conference theme of helping to introduce niche ideas to a wider group of people. I am a bit outside the target demographic myself. Tech Mesh is full of ideas with ten thousand devotees trying to spread themselves to the next million. I am more comfortable with the smaller memes myself, when everybody thinks you are mad and you have to work hard to convince the first ten or hundred people that you&#8217;re not. That is why I am working on high-performance networking firmware in userspace with LuaJIT device drivers. I suppose everybody has their own ideal proximity to mainstream thinking and that every technology is a moving target in that respect.</p>

<p>The organization was great. Plentiful food, coffee, and other beverages. A bit chilly but hey, this is England. The venue was right near the British Museum so I finally saw the Rosetta Stone for the first time. Thanks everybody!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/10/28/firmware-vs-software/">Firmware vs. Software</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-10-28T13:01:00+01:00" pubdate data-updated="true">Oct 28<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Firmware is great stuff. It&#8217;s the same as software and at the same
time it&#8217;s different. It&#8217;s a bit like visible and ultraviolet light:
they are fundamentally the same &#8220;stuff&#8221; but they are on different
parts of the spectrum.</p>

<ol>
<li>Firmware compiles to a self-contained image. The build process creates this one file and it has no external dependencies. There is a specific piece of hardware that can execute the image file.</li>
<li>Firmware has known space targets. They are usually measured in kilobytes. You always keep an eye on how much of your ROM and RAM budgets are used up.</li>
<li>Firmware is intimate with hardware. You don&#8217;t use libraries and frameworks, you control microchips. Your documentation is hardware data sheets and errata lists. Your job is to understand the hardware completely and make it sing.</li>
<li>Firmware is self-reliant. You take responsibility for every byte you ship in your image. That means being prepared to study and learn to debug any code that you choose to reuse. You always keep an eye on the total transitive complexity of the code you depend on.</li>
</ol>


<p>My favorite piece of firmware is <a href="http://www.openfirmware.info/Open_Firmware">Openfirmware</a>. This is shipped on a 1MB ROM chip in the <a href="http://en.wikipedia.org/wiki/OLPC_XO-1">OLPC XO</a> instead of a traditional BIOS. It&#8217;s a complete and self-sufficient software environment that has been carefully crafted over the past few decades by super-hacker <a href="http://howsoftwareisbuilt.com/2008/03/27/interview-with-mitch-bradley-firmware-olpc/">Mitch Bradley</a>. If you have an OLPC XO and would like to learn about firmware then I can recommend studying Mitch&#8217;s <a href="http://wiki.laptop.org/go/Forth_Lessons">Forth Lessons</a>.</p>

<p>These days we can choose to deploy our applications as firmware, software, and increasingly as full-scale OS distributions &#8211; kilobytes, megabytes, or gigabytes. There is sometimes one style that&#8217;s clearly the best and other times several options are all reasonable choices.</p>

<p>Firmware is fun and refreshing to write. I have chosen to develop my new <a href="http://www.github.com/SnabbCo/snabbswitch/">Snabb Switch</a> project as firmware. I will post a lot more about the implications of this decision over time.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Check me out!</h1>
  <p>
    Personal: <a href="http://www.lukego.com/">My homepage</a><br/>
    Hacking: <a href="http://www.github.com/SnabbCo/snabbswitch">Snabb Switch</a><br/>
    Professional: <a href="http://www.snabb.co/">Snabb</a>
    <a href="http://www.snabb.co/"><img src="http://www.snabb.co/Tiger_snabb_128.png" alt="Snabb logo"/></a>
  </p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/06/23/echoing-packets-with-snabb-switch/">Echoing packets with Snabb Switch</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/19/recent-talks/">Recent talks</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/13/routing-traffic-between-local-applications-on-linux/">Routing traffic between local applications on Linux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/03/snabb-my-lab/">Snabb - my lab</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/04/cute-code/">Cute code</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("lukego", 5, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/lukego" class="twitter-follow-button" data-show-count="false">Follow @lukego</a>
  
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Luke Gorrie -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
